(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{474:function(e,t,n){"use strict";n.r(t);var r=n(12),o=(n(42),n(209),n(37),n(300),n(141)),l=(n(211),{components:{CoolLightBox:o.a},layout:"booking",data:function(){return{from:{},loading:!1,wantsToUpdate:!1,initialLoad:!1,file:null,lightboxIndex:null,guest:{id:"",email:"",email_confirm:"",phone:"",first_name:"",last_name:"",dob:"",gender:"",concerns:" ",identification:"",hear_of_us:"",agreed_mailinglist:!0,is_member:!1}}},computed:{itemsForLightBox:function(){return[this.guest.identification]},last18Year:function(){var e=(new Date).getFullYear();return console.log(e-18),e-18},agreed:{set:function(e){return this.$store.commit("GUEST_SAVE_DATA",e)},get:function(){return this.$store.state.saveForNextTime}},weHaveData:{set:function(e){return this.$store.commit("GUEST_WEHAVEDATA",e)},get:function(){return this.$store.state.weHaveData}},showFullForm:function(){return!0},hasFileUpload:function(){return!!this.file}},methods:{isPdf:function(e){return!!e&&"pdf"==e.split(".").pop().toLowerCase()},gotoNext:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("go to next"),!e.initialLoad||e.wantsToUpdate){t.next=5;break}return console.log("sd"),e.confirmGuest(),t.abrupt("return");case 5:if(console.log("sss"),n=new FormData,!e.hasFileUpload){t.next=11;break}n.append("identification",e.file),t.next=14;break;case 11:if(e.guest.identification){t.next=14;break}return e.$toast.info("Please you must include a means of identification"),t.abrupt("return");case 14:if(e.guest.id&&n.append("id",e.guest.id),n.append("email",e.guest.email),n.append("phone",e.guest.phone),n.append("first_name",e.guest.first_name),n.append("last_name",e.guest.last_name),n.append("dob",e.guest.dob),n.append("gender",e.guest.gender),n.append("concerns",e.guest.concerns?e.guest.concerns:" "),n.append("hear_of_us",e.guest.hear_of_us),n.append("agreed_mailinglist",e.guest.agreed_mailinglist),e.$store.commit("UPDATE_GUEST",{guest:Object.assign({},e.guest),guestFormData:n}),!e.showFullForm){t.next=43;break}return console.log("go and save"),t.prev=27,t.next=30,e.saveGuest(n);case 30:t.next=39;break;case 32:return t.prev=32,t.t0=t.catch(27),console.log("Catch me here"),console.log(t.t0),e.loading=!1,e.$toast.error(null!==(r=t.t0.message)&&void 0!==r?r:t.t0),t.abrupt("return");case 39:e.$store.commit("COMPLETE_PROFILE"),e.$router.push({path:"/profile/more"}),t.next=45;break;case 43:e.$store.commit("COMPLETE_PROFILE"),e.$router.push({path:"/profile/more"});case 45:e.loading=!1;case 46:case"end":return t.stop()}}),t,null,[[27,32]])})))()},gotoBack:function(){this.$router.go(-1)},submitFile:function(){(new FormData).append("file",this.file)},handleFileUpload:function(){this.file=this.$refs.file.files[0],console.log(">>>> 1st element in files array >>>> ",this.file);var e=parseFloat(this.file.size/1024).toFixed(2);console.log(e),e>990&&(console.log("Too big"),this.$toast.error("You cannot upload files larger than 1 MB"),this.file=null,this.$refs.file.value="")},confirmGuest:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isValidEmail(e.guest.email)){t.next=3;break}return e.$toast.show("Please enter a valid email address"),t.abrupt("return");case 3:if(e.guest.email==e.guest.email_confirm){t.next=6;break}return e.$toast.show("Please confirm that your email address is correct"),t.abrupt("return");case 6:return console.log("confirming guest"),e.loading=!0,t.next=10,e.$store.dispatch("confirmGuest",e.guest.email);case 10:(n=t.sent).success?(e.weHaveData=!0,r=n.data,e.guest=r,e.$store.commit("UPDATE_GUEST",{guest:Object.assign({},r)}),e.$toast.success(n.message)):(e.weHaveData=!1,e.wantsToUpdate=!0,e.$store.commit("UPDATE_GUEST",{guest:Object.assign({})})),e.loading=!1,e.initialLoad=!1;case 14:case"end":return t.stop()}}),t)})))()},saveGuest:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.isValidEmail(t.guest.email)){n.next=3;break}return t.$toast.show("Please enter a valid email address"),n.abrupt("return");case 3:if(t.guest.email==t.guest.email_confirm){n.next=5;break}throw new Error("Please confirm that your email address is correct");case 5:return t.loading=!0,n.prev=6,n.next=9,t.$store.dispatch("saveGuest",e);case 9:return r=n.sent,t.loading=!1,n.abrupt("return",r);case 14:throw n.prev=14,n.t0=n.catch(6),t.loading=!1,t.$toast.error("Something went wrong, please try again"),new Error("Something went wrong, please try again");case 19:t.loading=!1;case 20:case"end":return n.stop()}}),n,null,[[6,14]])})))()},isValidEmail:function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}},created:function(){console.log("CREATED PROFILE"),this.$store.state.guest&&(this.guest=Object.assign({},this.$store.state.guest),this.guest.email&&(this.guest.email_confirm=this.guest.email))},middleware:function(e){var t=e.store,n=e.redirect;e.$toast;t.state.availability_done||n("/availability")}}),d=n(4),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",{staticClass:"px-6 mb-6 text-xl font-bold text-center md:px-0 md:text-2xl"},[e._v("Please give us some information about you")]),e._v(" "),n("div",{staticClass:"flex flex-col justify-center space-y-6 md:flex-row md:space-y-0 md:space-x-6"},[n("div",{staticClass:"w-full md:w-6/12"},[n("form",{staticClass:"px-6 pt-6 text-gray-700 bg-white border-t border-b md:border md:rounded-lg md:shadow-lg",on:{submit:function(e){e.preventDefault()}}},[n("div",{staticClass:"border rounded-md"},[n("div",{staticClass:"grid px-3 py-4 space-y-3 border-b md:grid-cols-2 md:space-y-0 md:space-x-3"},[n("div",[n("div",{staticClass:"text-base font-bold"},[e._v("Email address")]),e._v(" "),n("div",{staticClass:"flex items-center"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.guest.email,expression:"guest.email"}],staticClass:"w-full px-2 border-transparent rounded-md bg-brand-blue-100",staticStyle:{"box-shadow":"none"},attrs:{type:"email",required:""},domProps:{value:e.guest.email},on:{input:function(t){t.target.composing||e.$set(e.guest,"email",t.target.value)}}}),e._v(" "),e.loading?n("Loading"):e._e(),e._v(" "),e.weHaveData&&!e.wantsToUpdate?n("svg",{staticClass:"inline-block w-6 h-6 mr-2 text-green-500",attrs:{fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"}})]):e._e()],1),e._v(" "),n("div",{staticClass:"mt-2"},[n("div",{staticClass:"text-base font-bold"},[e._v("Email address confirmation")]),e._v(" "),n("div",{staticClass:"flex items-center"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.guest.email_confirm,expression:"guest.email_confirm"}],staticClass:"w-full px-2 border-transparent rounded-md bg-brand-blue-100",staticStyle:{"box-shadow":"none"},attrs:{type:"email",required:""},domProps:{value:e.guest.email_confirm},on:{input:function(t){t.target.composing||e.$set(e.guest,"email_confirm",t.target.value)}}})])])]),e._v(" "),e.showFullForm?n("div",[n("div",{staticClass:"text-base font-bold"},[e._v("Phone number")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.guest.phone,expression:"guest.phone"}],staticClass:"w-full px-2 border-transparent rounded-md bg-brand-blue-100",staticStyle:{"box-shadow":"none"},attrs:{type:"tel",required:""},domProps:{value:e.guest.phone},on:{input:function(t){t.target.composing||e.$set(e.guest,"phone",t.target.value)}}})]):e._e()]),e._v(" "),e.weHaveData&&!e.wantsToUpdate?n("div",{staticClass:"px-3 py-4 border-b"},[n("div",[e._v("\n                            Hi "+e._s(e.guest.first_name)+", welcome back to Jara Beach Resort.\n                            We have used your details from the last booking,\n                            however if you would like to make any changes\n                            "),n("span",{staticClass:"font-bold cursor-pointer text-brand-blue",on:{click:function(t){e.wantsToUpdate=!0}}},[e._v("click here")]),e._v(".\n                        ")])]):e._e(),e._v(" "),e.showFullForm?[n("div",{staticClass:"grid px-3 py-4 space-y-3 border-b md:space-y-0 md:space-x-3 md:grid-cols-2"},[n("div",[n("div",{staticClass:"text-base font-bold"},[e._v("First Name")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.guest.first_name,expression:"guest.first_name"}],staticClass:"w-full px-2 border-transparent rounded-md bg-brand-blue-100",staticStyle:{"box-shadow":"none"},attrs:{required:"",type:"text"},domProps:{value:e.guest.first_name},on:{input:function(t){t.target.composing||e.$set(e.guest,"first_name",t.target.value)}}})]),e._v(" "),n("div",[n("div",{staticClass:"text-base font-bold"},[e._v("Last Name")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.guest.last_name,expression:"guest.last_name"}],staticClass:"w-full px-2 border-transparent rounded-md bg-brand-blue-100",staticStyle:{"box-shadow":"none"},attrs:{required:"",type:"text"},domProps:{value:e.guest.last_name},on:{input:function(t){t.target.composing||e.$set(e.guest,"last_name",t.target.value)}}})])]),e._v(" "),n("div",{staticClass:"grid px-3 py-4 space-y-3 border-b md:grid-cols-2 md:space-y-0 md:space-x-3"},[n("div",[n("div",{staticClass:"text-base font-bold"},[e._v("Gender")]),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.guest.gender,expression:"guest.gender"}],staticClass:"w-full px-2 border-transparent rounded-md bg-brand-blue-100",staticStyle:{"box-shadow":"none"},attrs:{required:""},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.guest,"gender",t.target.multiple?n:n[0])}}},[n("option",{attrs:{value:""}},[e._v("--SELECT--")]),e._v(" "),n("option",{attrs:{value:"male"}},[e._v("Male")]),e._v(" "),n("option",{attrs:{value:"female"}},[e._v("Female")])])]),e._v(" "),n("div",[n("div",{staticClass:"text-base font-bold"},[e._v("Date of Birth")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.guest.dob,expression:"guest.dob"}],ref:"dob",staticClass:"w-full px-2 border-transparent rounded-md bg-brand-blue-100",staticStyle:{"box-shadow":"none"},attrs:{type:"date",required:"",max:e.last18Year+"-01-01"},domProps:{value:e.guest.dob},on:{input:function(t){t.target.composing||e.$set(e.guest,"dob",t.target.value)}}})])]),e._v(" "),n("div",{staticClass:"px-3 py-4 border-b"},[n("div",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.guest.concerns,expression:"guest.concerns"}],staticClass:"w-full px-2 border-transparent rounded-md bg-brand-blue-100",attrs:{type:"text",placeholder:"State any dietary, or setup requirements (i.e. baby bathtub or children's cot)."},domProps:{value:e.guest.concerns},on:{input:function(t){t.target.composing||e.$set(e.guest,"concerns",t.target.value)}}})])]),e._v(" "),n("div",{staticClass:"px-3 py-4 border-b"},[n("div",[n("div",{staticClass:"mb-2 text-base font-bold"},[e._v("Upload Image [face] identification (i.e. passport, national ID, driver's license) - Max: 1 MB")]),e._v(" "),e.guest.identification&&!e.hasFileUpload?[e.isPdf(e.guest.identification)?n("div",{staticClass:"my-3"},[n("div",{staticClass:"inline-block px-3 py-3 rounded-lg cursor-pointer hover:bg-blue-100",on:{click:function(t){e.lightboxIndex=0}}},[n("svg",{staticClass:"w-12 h-12",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"}},[n("path",{attrs:{d:"M128 0c-17.6 0-32 14.4-32 32v448c0 17.6 14.4 32 32 32h320c17.6 0 32-14.4 32-32V128L352 0H128z",fill:"#e2e5e7"}}),e._v(" "),n("path",{attrs:{d:"M384 128h96L352 0v96c0 17.6 14.4 32 32 32z",fill:"#b0b7bd"}}),e._v(" "),n("path",{attrs:{fill:"#cad1d8",d:"M480 224l-96-96h96z"}}),e._v(" "),n("path",{attrs:{d:"M416 416c0 8.8-7.2 16-16 16H48c-8.8 0-16-7.2-16-16V256c0-8.8 7.2-16 16-16h352c8.8 0 16 7.2 16 16v160z",fill:"#f15642"}}),e._v(" "),n("g",{attrs:{fill:"#fff"}},[n("path",{attrs:{d:"M101.744 303.152c0-4.224 3.328-8.832 8.688-8.832h29.552c16.64 0 31.616 11.136 31.616 32.48 0 20.224-14.976 31.488-31.616 31.488h-21.36v16.896c0 5.632-3.584 8.816-8.192 8.816-4.224 0-8.688-3.184-8.688-8.816v-72.032zm16.88 7.28v31.872h21.36c8.576 0 15.36-7.568 15.36-15.504 0-8.944-6.784-16.368-15.36-16.368h-21.36zM196.656 384c-4.224 0-8.832-2.304-8.832-7.92v-72.672c0-4.592 4.608-7.936 8.832-7.936h29.296c58.464 0 57.184 88.528 1.152 88.528h-30.448zm8.064-72.912V368.4h21.232c34.544 0 36.08-57.312 0-57.312H204.72zM303.872 312.112v20.336h32.624c4.608 0 9.216 4.608 9.216 9.072 0 4.224-4.608 7.68-9.216 7.68h-32.624v26.864c0 4.48-3.184 7.92-7.664 7.92-5.632 0-9.072-3.44-9.072-7.92v-72.672c0-4.592 3.456-7.936 9.072-7.936h44.912c5.632 0 8.96 3.344 8.96 7.936 0 4.096-3.328 8.704-8.96 8.704h-37.248v.016z"}})]),e._v(" "),n("path",{attrs:{d:"M400 432H96v16h304c8.8 0 16-7.2 16-16v-16c0 8.8-7.2 16-16 16z",fill:"#cad1d8"}})]),e._v("\n                                            Identification\n                                        ")])]):n("img",{staticClass:"w-3/5",attrs:{src:e.guest.identification},on:{click:function(t){e.lightboxIndex=0}}})]:e._e(),e._v(" "),n("CoolLightBox",{attrs:{items:e.itemsForLightBox,index:e.lightboxIndex},on:{close:function(t){e.lightboxIndex=null}}}),e._v(" "),n("div",{staticClass:"inline-flex items-center mt-2 cursor-pointer",on:{click:function(t){return e.$refs.file.click()}}},[n("svg",{staticClass:"w-5 h-5 mr-2",attrs:{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M8.75 1.875v2.5A.625.625 0 009.375 5h2.5",stroke:"#225A89","stroke-width":".8","stroke-linecap":"round","stroke-linejoin":"round"}}),e._v(" "),n("path",{attrs:{d:"M10.625 13.125h-6.25a1.25 1.25 0 01-1.25-1.25v-8.75a1.25 1.25 0 011.25-1.25H8.75L11.875 5v6.875a1.25 1.25 0 01-1.25 1.25zM7.5 6.875v3.75",stroke:"#225A89","stroke-width":".8","stroke-linecap":"round","stroke-linejoin":"round"}}),e._v(" "),n("path",{attrs:{d:"M5.625 8.75L7.5 6.875 9.375 8.75",stroke:"#225A89","stroke-width":".8","stroke-linecap":"round","stroke-linejoin":"round"}})]),e._v(" "),e.hasFileUpload?n("span",[e._v(e._s(e.file.name))]):[e.guest.identification?n("span",[e._v("Update file")]):n("span",[e._v("Add file")])]],2),e._v(" "),n("input",{ref:"file",staticClass:"hidden",attrs:{type:"file",accept:"image/x-png,image/gif,image/jpeg,application/pdf"},on:{input:function(t){return e.handleFileUpload()}}})],2)]),e._v(" "),n("div",{staticClass:"px-3 py-4 border-b"},[n("div",[n("div",{staticClass:"text-base font-bold"},[e._v("How did you hear about us?")]),e._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.guest.hear_of_us,expression:"guest.hear_of_us"}],staticClass:"px-0 px-3 border-transparent rounded-md w-52 bg-brand-blue-100",staticStyle:{"box-shadow":"none"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.guest,"hear_of_us",t.target.multiple?n:n[0])}}},[n("option",{attrs:{value:""}},[e._v("--SELECT--")]),e._v(" "),n("option",{attrs:{value:"Social Media"}},[e._v("Social Media")]),e._v(" "),n("option",{attrs:{value:"Friend"}},[e._v("Friend")]),e._v(" "),n("option",{attrs:{value:"Website"}},[e._v("Website")]),e._v(" "),n("option",{attrs:{value:"Online Search"}},[e._v("Online Search")]),e._v(" "),n("option",{attrs:{value:"Radio"}},[e._v("Radio")]),e._v(" "),n("option",{attrs:{value:"Television"}},[e._v("Television")]),e._v(" "),n("option",{attrs:{value:"Word of Mouth"}},[e._v("Word of Mouth")])])])])]:e._e()],2),e._v(" "),e.showFullForm?n("div",{staticClass:"flex justify-start my-4"},[n("label",{staticClass:"inline-flex items-center cursor-pointer"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.guest.agreed_mailinglist,expression:"guest.agreed_mailinglist"}],staticClass:"w-4 h-4 mr-4 rounded-full text-brand-blue focus:ring-1 focus:ring-green-600",attrs:{type:"checkbox",checked:""},domProps:{checked:Array.isArray(e.guest.agreed_mailinglist)?e._i(e.guest.agreed_mailinglist,null)>-1:e.guest.agreed_mailinglist},on:{change:function(t){var n=e.guest.agreed_mailinglist,r=t.target,o=!!r.checked;if(Array.isArray(n)){var l=e._i(n,null);r.checked?l<0&&e.$set(e.guest,"agreed_mailinglist",n.concat([null])):l>-1&&e.$set(e.guest,"agreed_mailinglist",n.slice(0,l).concat(n.slice(l+1)))}else e.$set(e.guest,"agreed_mailinglist",o)}}}),e._v("\n                        Sign up for our mailing list\n                    ")])]):e._e(),e._v(" "),e.showFullForm?n("div",{staticClass:"flex justify-start my-4"},[n("label",{staticClass:"inline-flex items-center cursor-pointer"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.agreed,expression:"agreed"}],staticClass:"w-4 h-4 mr-4 rounded-full text-brand-blue focus:ring-1 focus:ring-green-600",attrs:{type:"checkbox",checked:""},domProps:{checked:Array.isArray(e.agreed)?e._i(e.agreed,null)>-1:e.agreed},on:{change:function(t){var n=e.agreed,r=t.target,o=!!r.checked;if(Array.isArray(n)){var l=e._i(n,null);r.checked?l<0&&(e.agreed=n.concat([null])):l>-1&&(e.agreed=n.slice(0,l).concat(n.slice(l+1)))}else e.agreed=o}}}),e._v("\n                        Remember information for next visit\n                    ")])]):e._e(),e._v(" "),n("div",{staticClass:"flex w-full my-6 space-x-2"},[n("MainButton",{attrs:{type:"button",outline:""},on:{click:function(t){return e.gotoBack()}}},[e._v("Back")]),e._v(" "),n("MainButton",{attrs:{loading:e.loading},on:{click:function(t){return e.gotoNext()}}},[e._v("Next")])],1)]),e._v(" "),n("div",{staticClass:"flex items-center w-full my-6 space-x-2"},[n("StartOverButton",{staticClass:"w-full"})],1)]),e._v(" "),n("div",{staticClass:"flex-shrink-0 w-full px-6 md:px-0 md:w-3/12"},[n("ReservationBox",{attrs:{showDiscount:""}})],1)])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Loading:n(158).default,MainButton:n(31).default,StartOverButton:n(206).default,ReservationBox:n(207).default})}}]);